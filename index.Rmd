--- 
title: "Bookdown Broken"
subtitle: "学习 R Markdown 功能和 Github Action 的测试环境"
author: "黄湘云"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
papersize: b5
fontsize: 10pt
graphics: yes
colorlinks: yes
mathspec: yes
lot: yes
lof: yes
geometry:
  - tmargin=2.5cm
  - bmargin=2.5cm
  - lmargin=3.0cm
  - rmargin=2.0cm
classoption: "UTF8,twoside,openany,table"
bibliography: 
  - book.bib
  - packages.bib
biblio-style: plainnat
natbiboptions: "authoryear,round"
link-citations: yes
description: "学习 R Markdown 功能和 Github Action 的测试环境."
github-repo: XiangyunHuang/bookdown-broken
# cover-image: ""
---

\mainmatter

```{r setup,include=FALSE}
knitr::opts_chunk$set(
  python.reticulate = TRUE
)
if(!is.na(Sys.getenv('CI', NA))) {
  # Remote macOS CI 环境
  reticulate::use_condaenv("r-reticulate", required = TRUE)
}
```

# 欢迎 {#welcome .unnumbered}
\chaptermark{欢迎}

::: {.rmdwarn data-latex="{警告}"}
Book in early development. Planned release in 202X. 
:::

::: {.flushright data-latex=""}
黄湘云  
北京, 北京
:::

```{python python-plotly, fig.cap="Python 版的 plotly", eval=knitr::is_html_output()}
import plotly.express as px

px.scatter(
    px.data.iris(),
    x="sepal_width",
    y="sepal_length",
    color="species",
    trendline="ols",
    template="simple_white",
    labels={
        "sepal_length": "Sepal Length (cm)",
        "sepal_width": "Sepal Width (cm)",
        "species": "Species of Iris",
    },
    title="Edgar Anderson's Iris Data",
    color_discrete_sequence=px.colors.qualitative.Set2,
)
```
```{python export-image, echo=FALSE, eval=!knitr::is_html_output()}
import plotly.express as px
fig = px.scatter(
    px.data.iris(),
    x="sepal_width",
    y="sepal_length",
    color="species",
    trendline="ols",
    template="simple_white",
    labels={
        "sepal_length": "Sepal Length (cm)",
        "sepal_width": "Sepal Width (cm)",
        "species": "Species of Iris",
    },
    title="Edgar Anderson's Iris Data",
    color_discrete_sequence=px.colors.qualitative.Set2,
)
fig.write_image("iris.png", engine="kaleido")
```
```{r iris, echo=FALSE, eval=!knitr::is_html_output(), fig.cap="插入图片", out.width="75%"}
knitr::include_graphics(path = "iris.png")
```

## 软件信息 {#session .unnumbered}
\index{xfun}

```{r}
xfun::session_info(packages = c(
  "knitr", "rmarkdown", "bookdown"
), dependencies = TRUE)
```


```{r include=FALSE,cache=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```
